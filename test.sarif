{
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/sarif-2.1/schema/sarif-schema-2.1.0.json",
  "version": "2.1.0",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "agent-security",
          "semanticVersion": "1.1.0",
          "informationUri": "https://github.com/empowered-humanity/agent-security",
          "rules": [
            {
              "id": "cape_user_authorized",
              "shortDescription": {
                "text": "CAPE attack - fake user authorization claim"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "mcp_tool_redefine",
              "shortDescription": {
                "text": "MCP Rug Pull - tool redefinition attack"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "zombai_persist_rule",
              "shortDescription": {
                "text": "ZombAI - persistent rule injection"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "arg_inject_go_test",
              "shortDescription": {
                "text": "Go test -exec flag injection (RCE)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "arg_inject_git_format",
              "shortDescription": {
                "text": "Git format hex encoding (payload injection)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "arg_inject_rg_pre",
              "shortDescription": {
                "text": "Ripgrep --pre flag with shell (RCE)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "asi03_privilege_relay",
              "shortDescription": {
                "text": "ASI03 - Privilege escalation via agent relay"
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "owaspAsi": "ASI03"
              }
            },
            {
              "id": "asi06_memory_persist",
              "shortDescription": {
                "text": "ASI06 - Memory persistence injection attempt"
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "owaspAsi": "ASI06"
              }
            },
            {
              "id": "asi10_self_replicate",
              "shortDescription": {
                "text": "ASI10 - Agent self-replication attempt"
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "owaspAsi": "ASI10"
              }
            },
            {
              "id": "mcp_tool_desc_injection",
              "shortDescription": {
                "text": "Prompt injection hidden in MCP tool description"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "mcp_tool_hidden_instruction",
              "shortDescription": {
                "text": "Hidden instruction embedded in tool metadata"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "mcp_tool_desc_system_prompt",
              "shortDescription": {
                "text": "System prompt markers in MCP tool description (injection attempt)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "eval_exec_usage",
              "shortDescription": {
                "text": "Eval/exec usage (code execution risk)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "langchain_palchain",
              "shortDescription": {
                "text": "PALChain/PythonREPL usage (code execution risk)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "recon_metadata_access",
              "shortDescription": {
                "text": "Cloud metadata service access attempt"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "arg_inject_tar_checkpoint",
              "shortDescription": {
                "text": "Tar checkpoint-action (GTFOBINS RCE)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "ssrf_internal",
              "shortDescription": {
                "text": "SSRF attempt to internal network"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "ssrf_metadata",
              "shortDescription": {
                "text": "SSRF to cloud metadata service"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "langchain_import_bypass",
              "shortDescription": {
                "text": "Dynamic import bypass (CVE-2023-44467)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "dangerous_module_import",
              "shortDescription": {
                "text": "Dangerous module call in generated code"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "pickle_loads",
              "shortDescription": {
                "text": "Insecure deserialization via pickle"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "asi01_objective_change",
              "shortDescription": {
                "text": "ASI01 - Objective modification attempt"
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "owaspAsi": "ASI01"
              }
            },
            {
              "id": "ignore_instructions",
              "shortDescription": {
                "text": "Attempt to override previous instructions"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "xml_structure_escape",
              "shortDescription": {
                "text": "XML boundary escape attempt"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "hierarchy_override",
              "shortDescription": {
                "text": "Attempt to override higher-priority instructions"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "mcp_tool_escalate_permissions",
              "shortDescription": {
                "text": "Tool description requesting privilege escalation"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "mcp_credential_in_url",
              "shortDescription": {
                "text": "Credential passed as URL parameter (exposed in logs, referrers)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "mcp_install_untrusted_registry",
              "shortDescription": {
                "text": "MCP package installed from untrusted registry"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "mcp_resource_hidden_instruction",
              "shortDescription": {
                "text": "Hidden instruction embedded in MCP resource content"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "external_content_marker",
              "shortDescription": {
                "text": "External content marker manipulation"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "css_zero_font",
              "shortDescription": {
                "text": "Zero font-size CSS (hidden text in emails)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "dont_tell_user",
              "shortDescription": {
                "text": "Instruction to hide action from user"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "identity_spoofing",
              "shortDescription": {
                "text": "User identity spoofing attempt"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "extract_credentials",
              "shortDescription": {
                "text": "Credential extraction attempt"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "skip_confirmation",
              "shortDescription": {
                "text": "Attempt to skip confirmation/approval"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "wildcard_cloud_domain",
              "shortDescription": {
                "text": "Wildcard cloud domain in allow-list"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "disable_security",
              "shortDescription": {
                "text": "Attempt to disable security features"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "container_escape",
              "shortDescription": {
                "text": "Container/sandbox escape instruction"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "docker_socket",
              "shortDescription": {
                "text": "Docker socket access (container escape vector)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "privileged_mode",
              "shortDescription": {
                "text": "Privileged mode request (sandbox escape)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "openai_api_key",
              "shortDescription": {
                "text": "OpenAI API key detected"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "anthropic_api_key",
              "shortDescription": {
                "text": "Anthropic API key detected"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "github_pat",
              "shortDescription": {
                "text": "GitHub Personal Access Token detected"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "github_oauth",
              "shortDescription": {
                "text": "GitHub OAuth token detected"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "aws_access_key",
              "shortDescription": {
                "text": "AWS Access Key ID detected"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "aws_secret_key",
              "shortDescription": {
                "text": "AWS Secret Access Key detected"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "google_api_key",
              "shortDescription": {
                "text": "Google API key detected"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "stripe_key",
              "shortDescription": {
                "text": "Stripe API key detected"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "slack_token",
              "shortDescription": {
                "text": "Slack token detected"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "password_assignment",
              "shortDescription": {
                "text": "Hardcoded password detected"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "connection_string",
              "shortDescription": {
                "text": "Database connection string with credentials"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "rsa_private_key",
              "shortDescription": {
                "text": "RSA private key detected"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "generic_private_key",
              "shortDescription": {
                "text": "Private key detected"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "env_file_access",
              "shortDescription": {
                "text": "Attempt to access .env file"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "aws_credentials_access",
              "shortDescription": {
                "text": "Attempt to access AWS credentials"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "rag_trigger_phrase",
              "shortDescription": {
                "text": "RAG poisoning trigger phrase pattern"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "rag_ignore_rules",
              "shortDescription": {
                "text": "RAG poisoning payload execution"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "cape_cross_agent_instruct",
              "shortDescription": {
                "text": "Instruction targeting another agent"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "arg_inject_find_exec",
              "shortDescription": {
                "text": "Find -exec flag injection"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "mcp_tool_coerce_call",
              "shortDescription": {
                "text": "Tool description coercing agent to preferentially call it"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "mcp_third_party_response_passthrough",
              "shortDescription": {
                "text": "Third-party API response passed directly to context without validation"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "mcp_log_sensitive_field",
              "shortDescription": {
                "text": "Sensitive data field being logged"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "mcp_context_dump_to_tool",
              "shortDescription": {
                "text": "Full conversation context serialized for tool call"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "mcp_cross_server_call",
              "shortDescription": {
                "text": "Cross-MCP server function call (escalation risk)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "arg_inject_fd_x",
              "shortDescription": {
                "text": "fd -x flag command execution"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "arg_inject_xargs",
              "shortDescription": {
                "text": "xargs -I flag command execution"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "missing_arg_separator_template",
              "shortDescription": {
                "text": "User input in shell command without argument separator (--)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "ssrf_localhost",
              "shortDescription": {
                "text": "SSRF attempt to localhost via request call"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "rm_rf",
              "shortDescription": {
                "text": "Recursive/forced file deletion"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "sql_drop",
              "shortDescription": {
                "text": "SQL DROP statement"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "shell_true",
              "shortDescription": {
                "text": "subprocess with shell=True (injection risk)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "asi03_impersonation",
              "shortDescription": {
                "text": "ASI03 - Identity impersonation attempt"
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "owaspAsi": "ASI03"
              }
            },
            {
              "id": "asi04_mcp_impersonation",
              "shortDescription": {
                "text": "ASI04 - MCP server connection (verify authenticity)"
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "owaspAsi": "ASI04"
              }
            },
            {
              "id": "asi08_cascade_trigger",
              "shortDescription": {
                "text": "ASI08 - Multi-agent cascade trigger"
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "owaspAsi": "ASI08"
              }
            },
            {
              "id": "html_comment_injection",
              "shortDescription": {
                "text": "Injection hidden in HTML comment"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "secret_assignment",
              "shortDescription": {
                "text": "Hardcoded secret/token detected"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "mcp_env_var_logged",
              "shortDescription": {
                "text": "Environment variables logged (potential secret exposure)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "mcp_plaintext_token_file",
              "shortDescription": {
                "text": "Token/credential written to plaintext file"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "mcp_hidden_context_tag",
              "shortDescription": {
                "text": "Hidden context tag that may conceal information from user"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "new_instructions",
              "shortDescription": {
                "text": "Attempt to inject new instructions"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "do_not_classify",
              "shortDescription": {
                "text": "Attempt to bypass processing"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "jailbreak_mode",
              "shortDescription": {
                "text": "Known jailbreak mode trigger"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "email_forward",
              "shortDescription": {
                "text": "Data exfiltration via email"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "hidden_html_element",
              "shortDescription": {
                "text": "CSS-hidden HTML element"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "css_white_on_white",
              "shortDescription": {
                "text": "White text color (potential hidden content)"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "mso_hide",
              "shortDescription": {
                "text": "Microsoft Office hidden content"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "clickable_link_instruction",
              "shortDescription": {
                "text": "Instruction to create clickable link"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "prompt_extraction_attempt",
              "shortDescription": {
                "text": "System prompt extraction attempt"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "risk_assessment_manipulation",
              "shortDescription": {
                "text": "Risk assessment manipulation"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "path_traversal_attempt",
              "shortDescription": {
                "text": "Path traversal targeting sensitive system paths"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "spotlighting_delimiter_forge",
              "shortDescription": {
                "text": "Attempt to forge spotlighting delimiters"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "spotlighting_marker_inject",
              "shortDescription": {
                "text": "Attempt to inject spotlighting markers"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "pre_approved_claim",
              "shortDescription": {
                "text": "Claim that action is pre-approved"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "image_beacon",
              "shortDescription": {
                "text": "Image beacon with data in URL parameters"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "generic_api_key",
              "shortDescription": {
                "text": "Generic API key assignment detected"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "ssh_key",
              "shortDescription": {
                "text": "SSH key detected"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "cape_trusted_source",
              "shortDescription": {
                "text": "CAPE attack - claiming trusted internal source"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "cape_internal_request",
              "shortDescription": {
                "text": "CAPE attack - fake internal authorization"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "session_smuggle",
              "shortDescription": {
                "text": "CrewAI-style session smuggling"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "gcg_suffix_pattern",
              "shortDescription": {
                "text": "GCG/EGD adversarial suffix pattern"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "role_assignment",
              "shortDescription": {
                "text": "Malicious role reassignment attempt"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "url_exfil",
              "shortDescription": {
                "text": "Data exfiltration via URL"
              },
              "defaultConfiguration": {
                "level": "error"
              }
            },
            {
              "id": "langchain_sitemap_loader",
              "shortDescription": {
                "text": "SitemapLoader usage (verify domain allowlist)"
              },
              "defaultConfiguration": {
                "level": "warning"
              }
            },
            {
              "id": "chmod_dangerous",
              "shortDescription": {
                "text": "Dangerous chmod permissions"
              },
              "defaultConfiguration": {
                "level": "warning"
              }
            },
            {
              "id": "instead_do",
              "shortDescription": {
                "text": "Subtle instruction override attempt"
              },
              "defaultConfiguration": {
                "level": "warning"
              }
            },
            {
              "id": "subtle_recommendation",
              "shortDescription": {
                "text": "Subtle product/service recommendation injection"
              },
              "defaultConfiguration": {
                "level": "warning"
              }
            },
            {
              "id": "encoding_decode_attempt",
              "shortDescription": {
                "text": "Encoding decode instruction (potential bypass)"
              },
              "defaultConfiguration": {
                "level": "warning"
              }
            },
            {
              "id": "mcp_version_unpinned",
              "shortDescription": {
                "text": "Unpinned dependency version (rug pull risk)"
              },
              "defaultConfiguration": {
                "level": "warning"
              }
            }
          ]
        }
      },
      "results": [
        {
          "ruleId": "cape_user_authorized",
          "level": "error",
          "message": {
            "text": "CAPE attack - fake user authorization claim"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 81,
                  "startColumn": 26
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "mcp_tool_redefine",
          "level": "error",
          "message": {
            "text": "MCP Rug Pull - tool redefinition attack"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 111,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "zombai_persist_rule",
          "level": "error",
          "message": {
            "text": "ZombAI - persistent rule injection"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 158,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "arg_inject_go_test",
          "level": "error",
          "message": {
            "text": "Go test -exec flag injection (RCE)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 118,
                  "startColumn": 21
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "arg_inject_go_test",
          "level": "error",
          "message": {
            "text": "Go test -exec flag injection (RCE)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 119,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "arg_inject_git_format",
          "level": "error",
          "message": {
            "text": "Git format hex encoding (payload injection)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 126,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "arg_inject_rg_pre",
          "level": "error",
          "message": {
            "text": "Ripgrep --pre flag with shell (RCE)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 132,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "asi03_privilege_relay",
          "level": "error",
          "message": {
            "text": "ASI03 - Privilege escalation via agent relay"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 152,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness",
            "owaspAsi": "ASI03"
          }
        },
        {
          "ruleId": "asi06_memory_persist",
          "level": "error",
          "message": {
            "text": "ASI06 - Memory persistence injection attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 158,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness",
            "owaspAsi": "ASI06"
          }
        },
        {
          "ruleId": "asi10_self_replicate",
          "level": "error",
          "message": {
            "text": "ASI10 - Agent self-replication attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 164,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness",
            "owaspAsi": "ASI10"
          }
        },
        {
          "ruleId": "mcp_tool_desc_injection",
          "level": "error",
          "message": {
            "text": "Prompt injection hidden in MCP tool description"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 268,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "mcp_tool_hidden_instruction",
          "level": "error",
          "message": {
            "text": "Hidden instruction embedded in tool metadata"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 280,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "mcp_tool_desc_system_prompt",
          "level": "error",
          "message": {
            "text": "System prompt markers in MCP tool description (injection attempt)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 391,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "eval_exec_usage",
          "level": "error",
          "message": {
            "text": "Eval/exec usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/engine-intelligence.test.ts"
                },
                "region": {
                  "startLine": 344,
                  "startColumn": 17
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload",
            "taintProximity": "direct"
          }
        },
        {
          "ruleId": "eval_exec_usage",
          "level": "error",
          "message": {
            "text": "Eval/exec usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/engine-intelligence.test.ts"
                },
                "region": {
                  "startLine": 351,
                  "startColumn": 8
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload",
            "taintProximity": "direct"
          }
        },
        {
          "ruleId": "eval_exec_usage",
          "level": "error",
          "message": {
            "text": "Eval/exec usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/engine-intelligence.test.ts"
                },
                "region": {
                  "startLine": 360,
                  "startColumn": 17
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload",
            "taintProximity": "nearby"
          }
        },
        {
          "ruleId": "eval_exec_usage",
          "level": "error",
          "message": {
            "text": "Eval/exec usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/engine-intelligence.test.ts"
                },
                "region": {
                  "startLine": 370,
                  "startColumn": 8
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload",
            "taintProximity": "nearby"
          }
        },
        {
          "ruleId": "eval_exec_usage",
          "level": "error",
          "message": {
            "text": "Eval/exec usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/engine-intelligence.test.ts"
                },
                "region": {
                  "startLine": 379,
                  "startColumn": 17
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload",
            "taintProximity": "nearby"
          }
        },
        {
          "ruleId": "eval_exec_usage",
          "level": "error",
          "message": {
            "text": "Eval/exec usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/engine-intelligence.test.ts"
                },
                "region": {
                  "startLine": 388,
                  "startColumn": 8
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload",
            "taintProximity": "nearby"
          }
        },
        {
          "ruleId": "eval_exec_usage",
          "level": "error",
          "message": {
            "text": "Eval/exec usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/engine-intelligence.test.ts"
                },
                "region": {
                  "startLine": 396,
                  "startColumn": 17
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload",
            "taintProximity": "nearby"
          }
        },
        {
          "ruleId": "eval_exec_usage",
          "level": "error",
          "message": {
            "text": "Eval/exec usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/engine-intelligence.test.ts"
                },
                "region": {
                  "startLine": 403,
                  "startColumn": 18
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload",
            "taintProximity": "nearby"
          }
        },
        {
          "ruleId": "langchain_palchain",
          "level": "error",
          "message": {
            "text": "PALChain/PythonREPL usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/scanner/engine.ts"
                },
                "region": {
                  "startLine": 219,
                  "startColumn": 55
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "nearby"
          }
        },
        {
          "ruleId": "recon_metadata_access",
          "level": "error",
          "message": {
            "text": "Cloud metadata service access attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 150,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "arg_inject_go_test",
          "level": "error",
          "message": {
            "text": "Go test -exec flag injection (RCE)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 24,
                  "startColumn": 19
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "arg_inject_go_test",
          "level": "error",
          "message": {
            "text": "Go test -exec flag injection (RCE)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 25,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "arg_inject_git_format",
          "level": "error",
          "message": {
            "text": "Git format hex encoding (payload injection)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 35,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "arg_inject_rg_pre",
          "level": "error",
          "message": {
            "text": "Ripgrep --pre flag with shell (RCE)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 45,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "arg_inject_tar_checkpoint",
          "level": "error",
          "message": {
            "text": "Tar checkpoint-action (GTFOBINS RCE)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 65,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "ssrf_internal",
          "level": "error",
          "message": {
            "text": "SSRF attempt to internal network"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 140,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "ssrf_metadata",
          "level": "error",
          "message": {
            "text": "SSRF to cloud metadata service"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 150,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "langchain_import_bypass",
          "level": "error",
          "message": {
            "text": "Dynamic import bypass (CVE-2023-44467)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 166,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "distant"
          }
        },
        {
          "ruleId": "dangerous_module_import",
          "level": "error",
          "message": {
            "text": "Dangerous module call in generated code"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 178,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "direct"
          }
        },
        {
          "ruleId": "eval_exec_usage",
          "level": "error",
          "message": {
            "text": "Eval/exec usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 102,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "direct"
          }
        },
        {
          "ruleId": "eval_exec_usage",
          "level": "error",
          "message": {
            "text": "Eval/exec usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 102,
                  "startColumn": 43
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "direct"
          }
        },
        {
          "ruleId": "eval_exec_usage",
          "level": "error",
          "message": {
            "text": "Eval/exec usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 187,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "direct"
          }
        },
        {
          "ruleId": "pickle_loads",
          "level": "error",
          "message": {
            "text": "Insecure deserialization via pickle"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 197,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "nearby"
          }
        },
        {
          "ruleId": "langchain_palchain",
          "level": "error",
          "message": {
            "text": "PALChain/PythonREPL usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 218,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "nearby"
          }
        },
        {
          "ruleId": "langchain_palchain",
          "level": "error",
          "message": {
            "text": "PALChain/PythonREPL usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 219,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "nearby"
          }
        },
        {
          "ruleId": "langchain_palchain",
          "level": "error",
          "message": {
            "text": "PALChain/PythonREPL usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 219,
                  "startColumn": 24
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "nearby"
          }
        },
        {
          "ruleId": "langchain_palchain",
          "level": "error",
          "message": {
            "text": "PALChain/PythonREPL usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 223,
                  "startColumn": 19
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "nearby"
          }
        },
        {
          "ruleId": "langchain_palchain",
          "level": "error",
          "message": {
            "text": "PALChain/PythonREPL usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 223,
                  "startColumn": 28
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "nearby"
          }
        },
        {
          "ruleId": "zombai_persist_rule",
          "level": "error",
          "message": {
            "text": "ZombAI - persistent rule injection"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/owasp-asi.ts"
                },
                "region": {
                  "startLine": 138,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "asi01_objective_change",
          "level": "error",
          "message": {
            "text": "ASI01 - Objective modification attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/owasp-asi.ts"
                },
                "region": {
                  "startLine": 37,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness",
            "owaspAsi": "ASI01"
          }
        },
        {
          "ruleId": "asi03_privilege_relay",
          "level": "error",
          "message": {
            "text": "ASI03 - Privilege escalation via agent relay"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/owasp-asi.ts"
                },
                "region": {
                  "startLine": 73,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness",
            "owaspAsi": "ASI03"
          }
        },
        {
          "ruleId": "asi06_memory_persist",
          "level": "error",
          "message": {
            "text": "ASI06 - Memory persistence injection attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/owasp-asi.ts"
                },
                "region": {
                  "startLine": 138,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness",
            "owaspAsi": "ASI06"
          }
        },
        {
          "ruleId": "asi10_self_replicate",
          "level": "error",
          "message": {
            "text": "ASI10 - Agent self-replication attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/owasp-asi.ts"
                },
                "region": {
                  "startLine": 241,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness",
            "owaspAsi": "ASI10"
          }
        },
        {
          "ruleId": "ignore_instructions",
          "level": "error",
          "message": {
            "text": "Attempt to override previous instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 133,
                  "startColumn": 44
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "ignore_instructions",
          "level": "error",
          "message": {
            "text": "Attempt to override previous instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 575,
                  "startColumn": 40
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "xml_structure_escape",
          "level": "error",
          "message": {
            "text": "XML boundary escape attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 587,
                  "startColumn": 62
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "hierarchy_override",
          "level": "error",
          "message": {
            "text": "Attempt to override higher-priority instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 133,
                  "startColumn": 44
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "hierarchy_override",
          "level": "error",
          "message": {
            "text": "Attempt to override higher-priority instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 575,
                  "startColumn": 40
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "mcp_tool_desc_injection",
          "level": "error",
          "message": {
            "text": "Prompt injection hidden in MCP tool description"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 133,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "mcp_tool_hidden_instruction",
          "level": "error",
          "message": {
            "text": "Hidden instruction embedded in tool metadata"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 156,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "mcp_tool_escalate_permissions",
          "level": "error",
          "message": {
            "text": "Tool description requesting privilege escalation"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 168,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "configuration_risk"
          }
        },
        {
          "ruleId": "mcp_credential_in_url",
          "level": "error",
          "message": {
            "text": "Credential passed as URL parameter (exposed in logs, referrers)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 232,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "mcp_install_untrusted_registry",
          "level": "error",
          "message": {
            "text": "MCP package installed from untrusted registry"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 498,
                  "startColumn": 19
                }
              }
            }
          ],
          "properties": {
            "classification": "supply_chain_risk"
          }
        },
        {
          "ruleId": "mcp_resource_hidden_instruction",
          "level": "error",
          "message": {
            "text": "Hidden instruction embedded in MCP resource content"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 570,
                  "startColumn": 18
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "mcp_resource_hidden_instruction",
          "level": "error",
          "message": {
            "text": "Hidden instruction embedded in MCP resource content"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 575,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "mcp_tool_desc_system_prompt",
          "level": "error",
          "message": {
            "text": "System prompt markers in MCP tool description (injection attempt)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 586,
                  "startColumn": 5
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "mcp_tool_desc_system_prompt",
          "level": "error",
          "message": {
            "text": "System prompt markers in MCP tool description (injection attempt)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 587,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "ignore_instructions",
          "level": "error",
          "message": {
            "text": "Attempt to override previous instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 24,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "ignore_instructions",
          "level": "error",
          "message": {
            "text": "Attempt to override previous instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 202,
                  "startColumn": 20
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "xml_structure_escape",
          "level": "error",
          "message": {
            "text": "XML boundary escape attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 104,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "external_content_marker",
          "level": "error",
          "message": {
            "text": "External content marker manipulation"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 123,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "css_zero_font",
          "level": "error",
          "message": {
            "text": "Zero font-size CSS (hidden text in emails)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 211,
                  "startColumn": 28
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "dont_tell_user",
          "level": "error",
          "message": {
            "text": "Instruction to hide action from user"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 245,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "hierarchy_override",
          "level": "error",
          "message": {
            "text": "Attempt to override higher-priority instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 23,
                  "startColumn": 30
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "hierarchy_override",
          "level": "error",
          "message": {
            "text": "Attempt to override higher-priority instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 202,
                  "startColumn": 20
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "hierarchy_override",
          "level": "error",
          "message": {
            "text": "Attempt to override higher-priority instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 287,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "identity_spoofing",
          "level": "error",
          "message": {
            "text": "User identity spoofing attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 350,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "extract_credentials",
          "level": "error",
          "message": {
            "text": "Credential extraction attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 316,
                  "startColumn": 41
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "mcp_tool_desc_injection",
          "level": "error",
          "message": {
            "text": "Prompt injection hidden in MCP tool description"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 23,
                  "startColumn": 5
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "mcp_tool_desc_system_prompt",
          "level": "error",
          "message": {
            "text": "System prompt markers in MCP tool description (injection attempt)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 305,
                  "startColumn": 5
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "skip_confirmation",
          "level": "error",
          "message": {
            "text": "Attempt to skip confirmation/approval"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 69,
                  "startColumn": 30
                }
              }
            }
          ],
          "properties": {
            "classification": "configuration_risk"
          }
        },
        {
          "ruleId": "skip_confirmation",
          "level": "error",
          "message": {
            "text": "Attempt to skip confirmation/approval"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 70,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "configuration_risk"
          }
        },
        {
          "ruleId": "wildcard_cloud_domain",
          "level": "error",
          "message": {
            "text": "Wildcard cloud domain in allow-list"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 105,
                  "startColumn": 33
                }
              }
            }
          ],
          "properties": {
            "classification": "configuration_risk"
          }
        },
        {
          "ruleId": "disable_security",
          "level": "error",
          "message": {
            "text": "Attempt to disable security features"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 114,
                  "startColumn": 30
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "disable_security",
          "level": "error",
          "message": {
            "text": "Attempt to disable security features"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 115,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "container_escape",
          "level": "error",
          "message": {
            "text": "Container/sandbox escape instruction"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 158,
                  "startColumn": 16
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "docker_socket",
          "level": "error",
          "message": {
            "text": "Docker socket access (container escape vector)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 178,
                  "startColumn": 21
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "privileged_mode",
          "level": "error",
          "message": {
            "text": "Privileged mode request (sandbox escape)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 182,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "privileged_mode",
          "level": "error",
          "message": {
            "text": "Privileged mode request (sandbox escape)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 187,
                  "startColumn": 26
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "openai_api_key",
          "level": "error",
          "message": {
            "text": "OpenAI API key detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 22,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "anthropic_api_key",
          "level": "error",
          "message": {
            "text": "Anthropic API key detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 32,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "github_pat",
          "level": "error",
          "message": {
            "text": "GitHub Personal Access Token detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 41,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "github_oauth",
          "level": "error",
          "message": {
            "text": "GitHub OAuth token detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 50,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "aws_access_key",
          "level": "error",
          "message": {
            "text": "AWS Access Key ID detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 59,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "aws_secret_key",
          "level": "error",
          "message": {
            "text": "AWS Secret Access Key detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 68,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "google_api_key",
          "level": "error",
          "message": {
            "text": "Google API key detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 77,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "stripe_key",
          "level": "error",
          "message": {
            "text": "Stripe API key detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 86,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "slack_token",
          "level": "error",
          "message": {
            "text": "Slack token detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 95,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "password_assignment",
          "level": "error",
          "message": {
            "text": "Hardcoded password detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 119,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "connection_string",
          "level": "error",
          "message": {
            "text": "Database connection string with credentials"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 138,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "rsa_private_key",
          "level": "error",
          "message": {
            "text": "RSA private key detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 153,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "generic_private_key",
          "level": "error",
          "message": {
            "text": "Private key detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 162,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "env_file_access",
          "level": "error",
          "message": {
            "text": "Attempt to access .env file"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 187,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "aws_credentials_access",
          "level": "error",
          "message": {
            "text": "Attempt to access AWS credentials"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 53,
                  "startColumn": 12
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "aws_credentials_access",
          "level": "error",
          "message": {
            "text": "Attempt to access AWS credentials"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 62,
                  "startColumn": 12
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "aws_credentials_access",
          "level": "error",
          "message": {
            "text": "Attempt to access AWS credentials"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 68,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "aws_credentials_access",
          "level": "error",
          "message": {
            "text": "Attempt to access AWS credentials"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 191,
                  "startColumn": 34
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "aws_credentials_access",
          "level": "error",
          "message": {
            "text": "Attempt to access AWS credentials"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 191,
                  "startColumn": 49
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "aws_credentials_access",
          "level": "error",
          "message": {
            "text": "Attempt to access AWS credentials"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 196,
                  "startColumn": 21
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "extract_credentials",
          "level": "error",
          "message": {
            "text": "Credential extraction attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 206,
                  "startColumn": 38
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "extract_credentials",
          "level": "error",
          "message": {
            "text": "Credential extraction attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 215,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "cape_user_authorized",
          "level": "error",
          "message": {
            "text": "CAPE attack - fake user authorization claim"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/agent-attacks.ts"
                },
                "region": {
                  "startLine": 28,
                  "startColumn": 19
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "mcp_tool_redefine",
          "level": "error",
          "message": {
            "text": "MCP Rug Pull - tool redefinition attack"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/agent-attacks.ts"
                },
                "region": {
                  "startLine": 102,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "rag_trigger_phrase",
          "level": "error",
          "message": {
            "text": "RAG poisoning trigger phrase pattern"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/agent-attacks.ts"
                },
                "region": {
                  "startLine": 158,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "rag_ignore_rules",
          "level": "error",
          "message": {
            "text": "RAG poisoning payload execution"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/agent-attacks.ts"
                },
                "region": {
                  "startLine": 167,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "zombai_persist_rule",
          "level": "error",
          "message": {
            "text": "ZombAI - persistent rule injection"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/agent-attacks.ts"
                },
                "region": {
                  "startLine": 219,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "recon_metadata_access",
          "level": "error",
          "message": {
            "text": "Cloud metadata service access attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/agent-attacks.ts"
                },
                "region": {
                  "startLine": 288,
                  "startColumn": 27
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "ssrf_metadata",
          "level": "error",
          "message": {
            "text": "SSRF to cloud metadata service"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/agent-attacks.ts"
                },
                "region": {
                  "startLine": 288,
                  "startColumn": 20
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "asi06_memory_persist",
          "level": "error",
          "message": {
            "text": "ASI06 - Memory persistence injection attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/agent-attacks.ts"
                },
                "region": {
                  "startLine": 219,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness",
            "owaspAsi": "ASI06"
          }
        },
        {
          "ruleId": "mcp_tool_desc_system_prompt",
          "level": "error",
          "message": {
            "text": "System prompt markers in MCP tool description (injection attempt)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/agent-attacks.ts"
                },
                "region": {
                  "startLine": 278,
                  "startColumn": 5
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "ignore_instructions",
          "level": "error",
          "message": {
            "text": "Attempt to override previous instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/README.md"
                },
                "region": {
                  "startLine": 106,
                  "startColumn": 18
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "ignore_instructions",
          "level": "error",
          "message": {
            "text": "Attempt to override previous instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/CLAUDE.md"
                },
                "region": {
                  "startLine": 54,
                  "startColumn": 38
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "xml_structure_escape",
          "level": "error",
          "message": {
            "text": "XML boundary escape attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/CLAUDE.md"
                },
                "region": {
                  "startLine": 56,
                  "startColumn": 33
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "hierarchy_override",
          "level": "error",
          "message": {
            "text": "Attempt to override higher-priority instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/CLAUDE.md"
                },
                "region": {
                  "startLine": 54,
                  "startColumn": 38
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "ignore_instructions",
          "level": "error",
          "message": {
            "text": "Attempt to override previous instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/specs/SPEC.md"
                },
                "region": {
                  "startLine": 82,
                  "startColumn": 27
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "eval_exec_usage",
          "level": "error",
          "message": {
            "text": "Eval/exec usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/specs/SPEC.md"
                },
                "region": {
                  "startLine": 130,
                  "startColumn": 29
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "nearby"
          }
        },
        {
          "ruleId": "pickle_loads",
          "level": "error",
          "message": {
            "text": "Insecure deserialization via pickle"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/specs/SPEC.md"
                },
                "region": {
                  "startLine": 131,
                  "startColumn": 38
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "nearby"
          }
        },
        {
          "ruleId": "env_file_access",
          "level": "error",
          "message": {
            "text": "Attempt to access .env file"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/specs/SPEC.md"
                },
                "region": {
                  "startLine": 169,
                  "startColumn": 58
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "ignore_instructions",
          "level": "error",
          "message": {
            "text": "Attempt to override previous instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 59,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "ignore_instructions",
          "level": "error",
          "message": {
            "text": "Attempt to override previous instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 60,
                  "startColumn": 29
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "ignore_instructions",
          "level": "error",
          "message": {
            "text": "Attempt to override previous instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 204,
                  "startColumn": 48
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "ignore_instructions",
          "level": "error",
          "message": {
            "text": "Attempt to override previous instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 268,
                  "startColumn": 51
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "ignore_instructions",
          "level": "error",
          "message": {
            "text": "Attempt to override previous instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 405,
                  "startColumn": 30
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "ignore_instructions",
          "level": "error",
          "message": {
            "text": "Attempt to override previous instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 411,
                  "startColumn": 29
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "ignore_instructions",
          "level": "error",
          "message": {
            "text": "Attempt to override previous instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 417,
                  "startColumn": 29
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "ignore_instructions",
          "level": "error",
          "message": {
            "text": "Attempt to override previous instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 419,
                  "startColumn": 37
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "xml_structure_escape",
          "level": "error",
          "message": {
            "text": "XML boundary escape attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 212,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "xml_structure_escape",
          "level": "error",
          "message": {
            "text": "XML boundary escape attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 391,
                  "startColumn": 79
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "css_zero_font",
          "level": "error",
          "message": {
            "text": "Zero font-size CSS (hidden text in emails)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 198,
                  "startColumn": 35
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "hierarchy_override",
          "level": "error",
          "message": {
            "text": "Attempt to override higher-priority instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 59,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "hierarchy_override",
          "level": "error",
          "message": {
            "text": "Attempt to override higher-priority instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 204,
                  "startColumn": 48
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "hierarchy_override",
          "level": "error",
          "message": {
            "text": "Attempt to override higher-priority instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 268,
                  "startColumn": 51
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "hierarchy_override",
          "level": "error",
          "message": {
            "text": "Attempt to override higher-priority instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 405,
                  "startColumn": 30
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "hierarchy_override",
          "level": "error",
          "message": {
            "text": "Attempt to override higher-priority instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 411,
                  "startColumn": 29
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "cape_cross_agent_instruct",
          "level": "error",
          "message": {
            "text": "Instruction targeting another agent"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 97,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "arg_inject_find_exec",
          "level": "error",
          "message": {
            "text": "Find -exec flag injection"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 137,
                  "startColumn": 21
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "arg_inject_find_exec",
          "level": "error",
          "message": {
            "text": "Find -exec flag injection"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 138,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "openai_api_key",
          "level": "error",
          "message": {
            "text": "OpenAI API key detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 172,
                  "startColumn": 38
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "github_pat",
          "level": "error",
          "message": {
            "text": "GitHub Personal Access Token detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 178,
                  "startColumn": 29
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "aws_access_key",
          "level": "error",
          "message": {
            "text": "AWS Access Key ID detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 184,
                  "startColumn": 40
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "password_assignment",
          "level": "error",
          "message": {
            "text": "Hardcoded password detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 190,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "aws_credentials_access",
          "level": "error",
          "message": {
            "text": "Attempt to access AWS credentials"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 184,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "aws_credentials_access",
          "level": "error",
          "message": {
            "text": "Attempt to access AWS credentials"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 186,
                  "startColumn": 53
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "mcp_tool_coerce_call",
          "level": "error",
          "message": {
            "text": "Tool description coercing agent to preferentially call it"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 274,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "mcp_third_party_response_passthrough",
          "level": "error",
          "message": {
            "text": "Third-party API response passed directly to context without validation"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 286,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "mcp_credential_in_url",
          "level": "error",
          "message": {
            "text": "Credential passed as URL parameter (exposed in logs, referrers)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 301,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "mcp_log_sensitive_field",
          "level": "error",
          "message": {
            "text": "Sensitive data field being logged"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 261,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "mcp_log_sensitive_field",
          "level": "error",
          "message": {
            "text": "Sensitive data field being logged"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 333,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "mcp_context_dump_to_tool",
          "level": "error",
          "message": {
            "text": "Full conversation context serialized for tool call"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 339,
                  "startColumn": 34
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload",
            "contextFlowChain": [
              "serialize@L339: const content = 'toolInput = JSON.stringify(context.messages)';",
              "external_call@L340: const findings = matchPatterns(mcpDataSecurityPatterns, content, 'handler.ts');"
            ]
          }
        },
        {
          "ruleId": "mcp_cross_server_call",
          "level": "error",
          "message": {
            "text": "Cross-MCP server function call (escalation risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 372,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "eval_exec_usage",
          "level": "error",
          "message": {
            "text": "Eval/exec usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/engine-intelligence.test.ts"
                },
                "region": {
                  "startLine": 479,
                  "startColumn": 54
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload",
            "taintProximity": "distant"
          }
        },
        {
          "ruleId": "password_assignment",
          "level": "error",
          "message": {
            "text": "Hardcoded password detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/engine-intelligence.test.ts"
                },
                "region": {
                  "startLine": 490,
                  "startColumn": 45
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "password_assignment",
          "level": "error",
          "message": {
            "text": "Hardcoded password detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/engine-intelligence.test.ts"
                },
                "region": {
                  "startLine": 503,
                  "startColumn": 45
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "mcp_context_dump_to_tool",
          "level": "error",
          "message": {
            "text": "Full conversation context serialized for tool call"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/engine-intelligence.test.ts"
                },
                "region": {
                  "startLine": 416,
                  "startColumn": 21
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload",
            "contextFlowChain": [
              "serialize@L416: 'const body = JSON.stringify({ context: messages });',",
              "external_call@L417: 'const result = await fetch(url, { body });',"
            ]
          }
        },
        {
          "ruleId": "mcp_context_dump_to_tool",
          "level": "error",
          "message": {
            "text": "Full conversation context serialized for tool call"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/engine-intelligence.test.ts"
                },
                "region": {
                  "startLine": 429,
                  "startColumn": 20
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload",
            "contextFlowChain": [
              "serialize@L429: 'const log = JSON.stringify({ messages: conversation });',",
              "external_call@L428: 'const response = await axios.post(url);',"
            ]
          }
        },
        {
          "ruleId": "mcp_context_dump_to_tool",
          "level": "error",
          "message": {
            "text": "Full conversation context serialized for tool call"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/engine-intelligence.test.ts"
                },
                "region": {
                  "startLine": 440,
                  "startColumn": 20
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload",
            "contextFlowChain": [
              "serialize@L440: 'const log = JSON.stringify({ messages: conversation });',",
              "external_call@L448: it('should detect tool_call as external', () => {"
            ]
          }
        },
        {
          "ruleId": "mcp_context_dump_to_tool",
          "level": "error",
          "message": {
            "text": "Full conversation context serialized for tool call"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/engine-intelligence.test.ts"
                },
                "region": {
                  "startLine": 450,
                  "startColumn": 20
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload",
            "contextFlowChain": [
              "serialize@L450: 'const ctx = JSON.stringify(context.messages);',",
              "external_call@L451: 'const result = tool_call(toolName, ctx);',"
            ]
          }
        },
        {
          "ruleId": "mcp_context_dump_to_tool",
          "level": "error",
          "message": {
            "text": "Full conversation context serialized for tool call"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/engine-intelligence.test.ts"
                },
                "region": {
                  "startLine": 460,
                  "startColumn": 20
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload",
            "contextFlowChain": [
              "serialize@L460: 'data = json.dump(conversation)',",
              "external_call@L461: 'requests.post(url, data=data)',"
            ]
          }
        },
        {
          "ruleId": "arg_inject_find_exec",
          "level": "error",
          "message": {
            "text": "Find -exec flag injection"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 54,
                  "startColumn": 19
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "arg_inject_find_exec",
          "level": "error",
          "message": {
            "text": "Find -exec flag injection"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "arg_inject_fd_x",
          "level": "error",
          "message": {
            "text": "fd -x flag command execution"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 74,
                  "startColumn": 19
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "arg_inject_fd_x",
          "level": "error",
          "message": {
            "text": "fd -x flag command execution"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 75,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "arg_inject_xargs",
          "level": "error",
          "message": {
            "text": "xargs -I flag command execution"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 84,
                  "startColumn": 19
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "arg_inject_xargs",
          "level": "error",
          "message": {
            "text": "xargs -I flag command execution"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 85,
                  "startColumn": 29
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "missing_arg_separator_template",
          "level": "error",
          "message": {
            "text": "User input in shell command without argument separator (--)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 102,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "ssrf_localhost",
          "level": "error",
          "message": {
            "text": "SSRF attempt to localhost via request call"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 130,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "dangerous_module_import",
          "level": "error",
          "message": {
            "text": "Dangerous module call in generated code"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 269,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "distant"
          }
        },
        {
          "ruleId": "langchain_palchain",
          "level": "error",
          "message": {
            "text": "PALChain/PythonREPL usage (code execution risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 224,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "distant"
          }
        },
        {
          "ruleId": "rm_rf",
          "level": "error",
          "message": {
            "text": "Recursive/forced file deletion"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 28
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "rm_rf",
          "level": "error",
          "message": {
            "text": "Recursive/forced file deletion"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 241,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "sql_drop",
          "level": "error",
          "message": {
            "text": "SQL DROP statement"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 250,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "shell_true",
          "level": "error",
          "message": {
            "text": "subprocess with shell=True (injection risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 268,
                  "startColumn": 35
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "distant"
          }
        },
        {
          "ruleId": "shell_true",
          "level": "error",
          "message": {
            "text": "subprocess with shell=True (injection risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 269,
                  "startColumn": 35
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "taintProximity": "distant"
          }
        },
        {
          "ruleId": "rm_rf",
          "level": "error",
          "message": {
            "text": "Recursive/forced file deletion"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/owasp-asi.ts"
                },
                "region": {
                  "startLine": 120,
                  "startColumn": 37
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "asi03_impersonation",
          "level": "error",
          "message": {
            "text": "ASI03 - Identity impersonation attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/owasp-asi.ts"
                },
                "region": {
                  "startLine": 84,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness",
            "owaspAsi": "ASI03"
          }
        },
        {
          "ruleId": "asi04_mcp_impersonation",
          "level": "error",
          "message": {
            "text": "ASI04 - MCP server connection (verify authenticity)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/owasp-asi.ts"
                },
                "region": {
                  "startLine": 101,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "supply_chain_risk",
            "owaspAsi": "ASI04"
          }
        },
        {
          "ruleId": "asi08_cascade_trigger",
          "level": "error",
          "message": {
            "text": "ASI08 - Multi-agent cascade trigger"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/owasp-asi.ts"
                },
                "region": {
                  "startLine": 184,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness",
            "owaspAsi": "ASI08"
          }
        },
        {
          "ruleId": "html_comment_injection",
          "level": "error",
          "message": {
            "text": "Injection hidden in HTML comment"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 570,
                  "startColumn": 41
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "html_comment_injection",
          "level": "error",
          "message": {
            "text": "Injection hidden in HTML comment"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 575,
                  "startColumn": 35
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "secret_assignment",
          "level": "error",
          "message": {
            "text": "Hardcoded secret/token detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 342,
                  "startColumn": 28
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "mcp_env_var_logged",
          "level": "error",
          "message": {
            "text": "Environment variables logged (potential secret exposure)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 102,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "mcp_tool_coerce_call",
          "level": "error",
          "message": {
            "text": "Tool description coercing agent to preferentially call it"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 144,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "mcp_third_party_response_passthrough",
          "level": "error",
          "message": {
            "text": "Third-party API response passed directly to context without validation"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 190,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "mcp_plaintext_token_file",
          "level": "error",
          "message": {
            "text": "Token/credential written to plaintext file"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 244,
                  "startColumn": 18
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "mcp_log_sensitive_field",
          "level": "error",
          "message": {
            "text": "Sensitive data field being logged"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 102,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "mcp_log_sensitive_field",
          "level": "error",
          "message": {
            "text": "Sensitive data field being logged"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 342,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "mcp_context_dump_to_tool",
          "level": "error",
          "message": {
            "text": "Full conversation context serialized for tool call"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 354,
                  "startColumn": 27
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability",
            "contextFlowChain": [
              "serialize@L354: example: 'toolInput = JSON.stringify(context.messages)',",
              "external_call@L358: name: 'mcp_data_encryption_disabled',"
            ]
          }
        },
        {
          "ruleId": "mcp_cross_server_call",
          "level": "error",
          "message": {
            "text": "Cross-MCP server function call (escalation risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 517,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "mcp_hidden_context_tag",
          "level": "error",
          "message": {
            "text": "Hidden context tag that may conceal information from user"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/mcp-checklist.ts"
                },
                "region": {
                  "startLine": 598,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "new_instructions",
          "level": "error",
          "message": {
            "text": "Attempt to inject new instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 34,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "do_not_classify",
          "level": "error",
          "message": {
            "text": "Attempt to bypass processing"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 52,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "jailbreak_mode",
          "level": "error",
          "message": {
            "text": "Known jailbreak mode trigger"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 77,
                  "startColumn": 25
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "jailbreak_mode",
          "level": "error",
          "message": {
            "text": "Known jailbreak mode trigger"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 78,
                  "startColumn": 21
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "email_forward",
          "level": "error",
          "message": {
            "text": "Data exfiltration via email"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 148,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "hidden_html_element",
          "level": "error",
          "message": {
            "text": "CSS-hidden HTML element"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 193,
                  "startColumn": 20
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "html_comment_injection",
          "level": "error",
          "message": {
            "text": "Injection hidden in HTML comment"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 197,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "html_comment_injection",
          "level": "error",
          "message": {
            "text": "Injection hidden in HTML comment"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 202,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "css_white_on_white",
          "level": "error",
          "message": {
            "text": "White text color (potential hidden content)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 220,
                  "startColumn": 28
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "mso_hide",
          "level": "error",
          "message": {
            "text": "Microsoft Office hidden content"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 229,
                  "startColumn": 28
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "clickable_link_instruction",
          "level": "error",
          "message": {
            "text": "Instruction to create clickable link"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 270,
                  "startColumn": 34
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "clickable_link_instruction",
          "level": "error",
          "message": {
            "text": "Instruction to create clickable link"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 271,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "prompt_extraction_attempt",
          "level": "error",
          "message": {
            "text": "System prompt extraction attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 306,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "risk_assessment_manipulation",
          "level": "error",
          "message": {
            "text": "Risk assessment manipulation"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 341,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "path_traversal_attempt",
          "level": "error",
          "message": {
            "text": "Path traversal targeting sensitive system paths"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 392,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "spotlighting_delimiter_forge",
          "level": "error",
          "message": {
            "text": "Attempt to forge spotlighting delimiters"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 19,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "spotlighting_delimiter_forge",
          "level": "error",
          "message": {
            "text": "Attempt to forge spotlighting delimiters"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 24,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "spotlighting_marker_inject",
          "level": "error",
          "message": {
            "text": "Attempt to inject spotlighting markers"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 34,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "spotlighting_marker_inject",
          "level": "error",
          "message": {
            "text": "Attempt to inject spotlighting markers"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 34,
                  "startColumn": 40
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "pre_approved_claim",
          "level": "error",
          "message": {
            "text": "Claim that action is pre-approved"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 73,
                  "startColumn": 12
                }
              }
            }
          ],
          "properties": {
            "classification": "configuration_risk"
          }
        },
        {
          "ruleId": "pre_approved_claim",
          "level": "error",
          "message": {
            "text": "Claim that action is pre-approved"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 78,
                  "startColumn": 40
                }
              }
            }
          ],
          "properties": {
            "classification": "configuration_risk"
          }
        },
        {
          "ruleId": "image_beacon",
          "level": "error",
          "message": {
            "text": "Image beacon with data in URL parameters"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 152,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "generic_api_key",
          "level": "error",
          "message": {
            "text": "Generic API key assignment detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 104,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "secret_assignment",
          "level": "error",
          "message": {
            "text": "Hardcoded secret/token detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 129,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "ssh_key",
          "level": "error",
          "message": {
            "text": "SSH key detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/credentials.ts"
                },
                "region": {
                  "startLine": 171,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "cape_trusted_source",
          "level": "error",
          "message": {
            "text": "CAPE attack - claiming trusted internal source"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/agent-attacks.ts"
                },
                "region": {
                  "startLine": 38,
                  "startColumn": 38
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "cape_internal_request",
          "level": "error",
          "message": {
            "text": "CAPE attack - fake internal authorization"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/agent-attacks.ts"
                },
                "region": {
                  "startLine": 46,
                  "startColumn": 38
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "cape_internal_request",
          "level": "error",
          "message": {
            "text": "CAPE attack - fake internal authorization"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/agent-attacks.ts"
                },
                "region": {
                  "startLine": 47,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "cape_cross_agent_instruct",
          "level": "error",
          "message": {
            "text": "Instruction targeting another agent"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/agent-attacks.ts"
                },
                "region": {
                  "startLine": 76,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "architectural_weakness"
          }
        },
        {
          "ruleId": "session_smuggle",
          "level": "error",
          "message": {
            "text": "CrewAI-style session smuggling"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/agent-attacks.ts"
                },
                "region": {
                  "startLine": 194,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "gcg_suffix_pattern",
          "level": "error",
          "message": {
            "text": "GCG/EGD adversarial suffix pattern"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/agent-attacks.ts"
                },
                "region": {
                  "startLine": 235,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "role_assignment",
          "level": "error",
          "message": {
            "text": "Malicious role reassignment attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/CLAUDE.md"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 31
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "url_exfil",
          "level": "error",
          "message": {
            "text": "Data exfiltration via URL"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/CLAUDE.md"
                },
                "region": {
                  "startLine": 57,
                  "startColumn": 31
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "rm_rf",
          "level": "error",
          "message": {
            "text": "Recursive/forced file deletion"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/CLAUDE.md"
                },
                "region": {
                  "startLine": 58,
                  "startColumn": 32
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "sql_drop",
          "level": "error",
          "message": {
            "text": "SQL DROP statement"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/CLAUDE.md"
                },
                "region": {
                  "startLine": 58,
                  "startColumn": 42
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "role_assignment",
          "level": "error",
          "message": {
            "text": "Malicious role reassignment attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/specs/SPEC.md"
                },
                "region": {
                  "startLine": 83,
                  "startColumn": 24
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "role_assignment",
          "level": "error",
          "message": {
            "text": "Malicious role reassignment attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/specs/SPEC.md"
                },
                "region": {
                  "startLine": 306,
                  "startColumn": 25
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "jailbreak_mode",
          "level": "error",
          "message": {
            "text": "Known jailbreak mode trigger"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/specs/SPEC.md"
                },
                "region": {
                  "startLine": 88,
                  "startColumn": 29
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "email_forward",
          "level": "error",
          "message": {
            "text": "Data exfiltration via email"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/specs/SPEC.md"
                },
                "region": {
                  "startLine": 305,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "rm_rf",
          "level": "error",
          "message": {
            "text": "Recursive/forced file deletion"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/specs/SPEC.md"
                },
                "region": {
                  "startLine": 86,
                  "startColumn": 25
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "sql_drop",
          "level": "error",
          "message": {
            "text": "SQL DROP statement"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/specs/SPEC.md"
                },
                "region": {
                  "startLine": 86,
                  "startColumn": 35
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "new_instructions",
          "level": "warning",
          "message": {
            "text": "Attempt to inject new instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 66,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "new_instructions",
          "level": "warning",
          "message": {
            "text": "Attempt to inject new instructions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 67,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "hidden_html_element",
          "level": "warning",
          "message": {
            "text": "CSS-hidden HTML element"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 204,
                  "startColumn": 27
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "generic_api_key",
          "level": "warning",
          "message": {
            "text": "Generic API key assignment detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 172,
                  "startColumn": 28
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "secret_assignment",
          "level": "warning",
          "message": {
            "text": "Hardcoded secret/token detected"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 333,
                  "startColumn": 35
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "mcp_env_var_logged",
          "level": "warning",
          "message": {
            "text": "Environment variables logged (potential secret exposure)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 261,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "classification": "credential_exposure"
          }
        },
        {
          "ruleId": "mcp_hidden_context_tag",
          "level": "warning",
          "message": {
            "text": "Hidden context tag that may conceal information from user"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/tests/patterns.test.ts"
                },
                "region": {
                  "startLine": 397,
                  "startColumn": 34
                }
              }
            }
          ],
          "properties": {
            "classification": "test_payload"
          }
        },
        {
          "ruleId": "langchain_sitemap_loader",
          "level": "warning",
          "message": {
            "text": "SitemapLoader usage (verify domain allowlist)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 213,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "chmod_dangerous",
          "level": "warning",
          "message": {
            "text": "Dangerous chmod permissions"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/rce.ts"
                },
                "region": {
                  "startLine": 259,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "instead_do",
          "level": "warning",
          "message": {
            "text": "Subtle instruction override attempt"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 43,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "subtle_recommendation",
          "level": "warning",
          "message": {
            "text": "Subtle product/service recommendation injection"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/injection.ts"
                },
                "region": {
                  "startLine": 332,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "encoding_decode_attempt",
          "level": "warning",
          "message": {
            "text": "Encoding decode instruction (potential bypass)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/src/patterns/defense-evasion.ts"
                },
                "region": {
                  "startLine": 43,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "classification": "live_vulnerability"
          }
        },
        {
          "ruleId": "mcp_version_unpinned",
          "level": "warning",
          "message": {
            "text": "Unpinned dependency version (rug pull risk)"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "C:/code/SECURITY/apps/agent-security/package.json"
                },
                "region": {
                  "startLine": 92,
                  "startColumn": 14
                }
              }
            }
          ],
          "properties": {
            "classification": "supply_chain_risk"
          }
        }
      ]
    }
  ]
}